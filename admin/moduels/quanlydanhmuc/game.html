<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trò Chơi Đố Vui Siêu VIP</title>
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --success: #00b894;
            --danger: #d63031;
            --warning: #fdcb6e;
            --info: #0984e3;
            --dark: #2d3436;
            --light: #dfe6e9;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #2d3436;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 5px;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .header p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(108, 92, 231, 0.6);
            background: #5649c0;
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn:disabled {
            background-color: #b2bec3;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        
        .button-container {
            text-align: center;
            margin-top: 25px;
        }
        
        /* Intro Screen */
        .game-modes {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .mode-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            width: 200px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .mode-card.selected {
            border: 3px solid var(--primary);
            transform: translateY(-5px);
        }
        
        .mode-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }
        
        .mode-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .mode-desc {
            font-size: 14px;
            color: #636e72;
        }
        
        /* Quiz Screen */
        .progress-container {
            margin-bottom: 25px;
        }
        
        .progress-bar {
            background-color: #e0e0e0;
            height: 10px;
            border-radius: 50px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        
        .progress {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            height: 100%;
            border-radius: 50px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #636e72;
        }
        
        .question-container {
            margin-bottom: 30px;
        }
        
        .question {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--dark);
            line-height: 1.4;
        }
        
        .image-container {
            max-width: 100%;
            height: 250px;
            margin: 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .question-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .puzzle-container {
            max-width: 400px;
            height: 400px;
            margin: 20px auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            position: relative;
        }
        
        .puzzle-piece {
            background-size: 300% 300%;
            border: 2px solid white;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s;
        }
        
        .puzzle-piece:hover {
            transform: scale(0.98);
        }
        
        /* Options */
        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .option {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }
        
        .option:hover {
            border-color: var(--primary);
            background-color: #f5f5f5;
        }
        
        .option.selected {
            background-color: var(--secondary);
            color: white;
            border-color: var(--primary);
        }
        
        .option.correct {
            background-color: var(--success);
            color: white;
            border-color: #009670;
        }
        
        .option.incorrect {
            background-color: var(--danger);
            color: white;
            border-color: #b02324;
        }
        
        .option-prefix {
            font-weight: bold;
            margin-right: 10px;
            min-width: 25px;
            height: 25px;
            background: var(--light);
            color: var(--dark);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14px;
        }
        
        .option.selected .option-prefix,
        .option.correct .option-prefix,
        .option.incorrect .option-prefix {
            background: white;
        }
        
        /* Feedback */
        .feedback {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 18px;
        }
        
        .feedback.correct {
            background-color: rgba(0, 184, 148, 0.2);
            color: var(--success);
        }
        
        .feedback.incorrect {
            background-color: rgba(214, 48, 49, 0.2);
            color: var(--danger);
        }
        
        /* Timer */
        .timer-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .timer {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .timer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: conic-gradient(var(--primary) 0%, transparent 0%);
            border-radius: 50%;
            transition: background 1s linear;
        }
        
        /* Result Screen */
        .result-container {
            text-align: center;
            padding: 20px;
        }
        
        .score-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .score-title {
            font-size: 24px;
            margin-bottom: 15px;
            color: var(--dark);
        }
        
        .score {
            font-size: 72px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .score-text {
            font-size: 18px;
            color: #636e72;
        }
        
        .achievements {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .achievement {
            background: white;
            border-radius: 10px;
            padding: 15px;
            width: 150px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .achievement-icon {
            font-size: 30px;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .achievement-title {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .achievement-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .hide {
            display: none;
        }
        
        /* Different question types styling */
        .fill-blank input {
            border: none;
            border-bottom: 2px solid var(--primary);
            padding: 8px;
            font-size: 16px;
            margin: 0 5px;
            text-align: center;
            width: 120px;
            background: rgba(108, 92, 231, 0.1);
        }
        
        .fill-blank input:focus {
            outline: none;
            border-bottom: 2px solid var(--secondary);
        }
        
        .reorder-list {
            list-style-type: none;
            padding: 0;
        }
        
        .reorder-item {
            background: white;
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: grab;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
        }
        
        .reorder-item:active {
            cursor: grabbing;
        }
        
        .reorder-handle {
            margin-right: 10px;
            color: #b2bec3;
        }
        
        /* Media Queries */
        @media (max-width: 768px) {
            .options {
                grid-template-columns: 1fr;
            }
            
            .game-modes {
                flex-direction: column;
                align-items: center;
            }
            
            .puzzle-container {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Trò Chơi Đố Vui Siêu VIP</h1>
            <p>Thử thách trí tuệ với nhiều dạng câu đố hấp dẫn!</p>
        </div>
        
        <div class="content">
            <!-- Intro Screen -->
            <div id="intro-screen">
                <p>Chọn chế độ chơi bạn thích:</p>
                
                <div class="game-modes">
                    <div class="mode-card" data-mode="trivia">
                        <div class="mode-icon">🎯</div>
                        <div class="mode-title">Đố Vui Kiến Thức</div>
                        <div class="mode-desc">Trả lời các câu hỏi kiến thức đa dạng</div>
                    </div>
                    
                    <div class="mode-card" data-mode="image">
                        <div class="mode-icon">🖼️</div>
                        <div class="mode-title">Đoán Hình Ảnh</div>
                        <div class="mode-desc">Đoán nội dung từ hình ảnh</div>
                    </div>
                    
                    <div class="mode-card" data-mode="puzzle">
                        <div class="mode-icon">🧩</div>
                        <div class="mode-title">Ghép Hình</div>
                        <div class="mode-desc">Sắp xếp các mảnh ghép đúng vị trí</div>
                    </div>
                    
                    <div class="mode-card" data-mode="mixed">
                        <div class="mode-icon">🎮</div>
                        <div class="mode-title">Hỗn Hợp</div>
                        <div class="mode-desc">Kết hợp tất cả các dạng câu đố</div>
                    </div>
                </div>
                
                <div class="button-container">
                    <button id="start-btn" class="btn" disabled>Bắt Đầu Chơi</button>
                </div>
            </div>
            
            <!-- Quiz Screen -->
            <div id="quiz-screen" class="hide">
                <div class="timer-container">
                    <div class="timer" id="timer"><span id="time">30</span></div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress" id="progress"></div>
                    </div>
                    <div class="progress-text">
                        <span>Câu hỏi <span id="current-question">1</span>/<span id="total-questions">10</span></span>
                        <span>Điểm: <span id="current-score">0</span></span>
                    </div>
                </div>
                
                <div class="question-container">
                    <div class="question" id="question-text"></div>
                    
                    <!-- Image Question Type -->
                    <div id="image-container" class="image-container hide">
                        <img id="question-image" class="question-image" src="" alt="Câu đố hình ảnh">
                    </div>
                    
                    <!-- Puzzle Question Type -->
                    <div id="puzzle-container" class="puzzle-container hide"></div>
                </div>
                
                <div id="options-container" class="options"></div>
                
                <div id="feedback" class="feedback"></div>
                
                <div class="button-container">
                    <button id="next-btn" class="btn" disabled>Câu Tiếp Theo</button>
                </div>
            </div>
            
            <!-- Result Screen -->
            <div id="result-screen" class="hide">
                <div class="result-container">
                    <h2>Kết Quả</h2>
                    
                    <div class="score-container">
                        <div class="score-title">Điểm Số Của Bạn</div>
                        <div class="score"><span id="final-score">0</span></div>
                        <div class="score-text">trên <span id="max-score">10</span> điểm</div>
                    </div>
                    
                    <div class="achievements">
                        <div class="achievement">
                            <div class="achievement-icon">⏱️</div>
                            <div class="achievement-title">Thời Gian</div>
                            <div class="achievement-value"><span id="total-time">0</span>s</div>
                        </div>
                        
                        <div class="achievement">
                            <div class="achievement-icon">✅</div>
                            <div class="achievement-title">Đúng</div>
                            <div class="achievement-value"><span id="correct-answers">0</span></div>
                        </div>
                        
                        <div class="achievement">
                            <div class="achievement-icon">⚡</div>
                            <div class="achievement-title">Nhanh Nhất</div>
                            <div class="achievement-value"><span id="fastest-answer">0</span>s</div>
                        </div>
                    </div>
                    
                    <div class="button-container">
                        <button id="restart-btn" class="btn">Chơi Lại</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Các biến toàn cục
        let currentQuestionIndex = 0;
        let score = 0;
        let timer;
        let timeLeft = 30;
        let hasAnswered = false;
        let selectedMode = '';
        let gameQuestions = [];
        let totalTime = 0;
        let correctAnswers = 0;
        let fastestAnswer = 30;
        let currentAnswerTime = 0;
        
        // Các phần tử DOM
        const introScreen = document.getElementById('intro-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        const startBtn = document.getElementById('start-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const feedbackElement = document.getElementById('feedback');
        const currentQuestionElement = document.getElementById('current-question');
        const totalQuestionsElement = document.getElementById('total-questions');
        const progressElement = document.getElementById('progress');
        const currentScoreElement = document.getElementById('current-score');
        const finalScoreElement = document.getElementById('final-score');
        const maxScoreElement = document.getElementById('max-score');
        const timeElement = document.getElementById('time');
        const timerElement = document.getElementById('timer');
        const imageContainer = document.getElementById('image-container');
        const questionImage = document.getElementById('question-image');
        const puzzleContainer = document.getElementById('puzzle-container');
        const totalTimeElement = document.getElementById('total-time');
        const correctAnswersElement = document.getElementById('correct-answers');
        const fastestAnswerElement = document.getElementById('fastest-answer');
        
        // Cơ sở dữ liệu các câu hỏi
        const triviaQuestions = [
            {
                type: 'multiple-choice',
                question: "Thủ đô của Việt Nam là gì?",
                options: ["Hà Nội", "Hồ Chí Minh", "Đà Nẵng", "Huế"],
                correctAnswer: 0
            },
            {
                type: 'multiple-choice',
                question: "Loại đơn vị tiền tệ của Nhật Bản là gì?",
                options: ["Won", "Yuan", "Yen", "Baht"],
                correctAnswer: 2
            },
            {
                type: 'multiple-choice',
                question: "Đâu không phải là một ngôn ngữ lập trình?",
                options: ["Java", "Python", "HTML", "Banana"],
                correctAnswer: 3
            },
            {
                type: 'true-false',
                question: "Mặt trời quay quanh trái đất?",
                options: ["Đúng", "Sai"],
                correctAnswer: 1
            },
            {
                type: 'fill-blank',
                question: "Hoàn thành câu thành ngữ: Có công mài sắt, có ngày _____ .",
                answer: "nên kim"
            }
        ];
        
        const imageQuestions = [
            {
                type: 'image-choice',
                question: "Đây là quốc kỳ của nước nào?",
                imageUrl: "/api/placeholder/400/300",
                options: ["Pháp", "Hà Lan", "Italia", "Luxembourg"],
                correctAnswer: 0
            },
            {
                type: 'image-choice',
                question: "Đây là loài động vật nào?",
                imageUrl: "/api/placeholder/400/300",
                options: ["Gấu trúc", "Koala", "Gấu Bắc cực", "Chó Husky"],
                correctAnswer: 1
            },
            {
                type: 'image-choice',
                question: "Đây là công trình kiến trúc gì?",
                imageUrl: "/api/placeholder/400/300",
                options: ["Tháp Eiffel", "Tháp nghiêng Pisa", "Tháp London", "Tháp CN"],
                correctAnswer: 0
            },
            {
                type: 'image-choice',
                question: "Bức tranh này thuộc phong cách nào?",
                imageUrl: "/api/placeholder/400/300",
                options: ["Ấn tượng", "Lập thể", "Hiện thực", "Trừu tượng"],
                correctAnswer: 1
            },
            {
                type: 'image-choice',
                question: "Đây là logo của công ty nào?",
                imageUrl: "/api/placeholder/400/300",
                options: ["Apple", "Microsoft", "Google", "Amazon"],
                correctAnswer: 2
            }
        ];
        
        const puzzleQuestions = [
            {
                type: 'puzzle',
                question: "Hãy ghép hình ảnh này bằng cách di chuyển các mảnh ghép.",
                imageUrl: "/api/placeholder/300/300",
                difficulty: "easy"
            },
            {
                type: 'puzzle',
                question: "Ghép hình ảnh Hạ Long bằng cách di chuyển các mảnh ghép.",
                imageUrl: "/api/placeholder/300/300",
                difficulty: "medium"
            },
            {
                type: 'puzzle',
                question: "Ghép hình bản đồ Việt Nam.",
                imageUrl: "/api/placeholder/300/300",
                difficulty: "hard"
            }
        ];
        
        // Chọn chế độ chơi
        const modeCards = document.querySelectorAll('.mode-card');
        modeCards.forEach(card => {
            card.addEventListener('click', () => {
                modeCards.forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');
                selectedMode = card.dataset.mode;
                startBtn.disabled = false;
            });
        });
        
        // Bắt đầu trò chơi
        startBtn.addEventListener('click', startGame);
        nextBtn.addEventListener('click', goToNextQuestion);
        restartBtn.addEventListener('click', restartGame);
        
        function startGame() {
            // Thiết lập câu hỏi dựa trên chế độ đã chọn
            setupQuestions();
            
            // Ẩn màn hình giới thiệu, hiển thị màn hình câu hỏi
            introScreen.classList.add('hide');
            quizScreen.classList.remove('hide');
            
            // Reset các biến
            currentQuestionIndex = 0;
            score = 0;
            totalTime = 0;
            correctAnswers = 0;
            fastestAnswer = 30;
            
            // Cập nhật tổng số câu hỏi
            totalQuestionsElement.textContent = gameQuestions.length;
            maxScoreElement.textContent = gameQuestions.length;
            
            // Tải câu hỏi đầu tiên
            loadQuestion();
        }
        
        function setupQuestions() {
            switch(selectedMode) {
                case 'trivia':
                    gameQuestions = [...triviaQuestions];
                    break;
                case 'image':
                    gameQuestions = [...imageQuestions];
                    break;
                case 'puzzle':
                    gameQuestions = [...puzzleQuestions];
                    break;
                case 'mixed':
                    // Kết hợp tất cả các loại câu hỏi
                    gameQuestions = [...triviaQuestions, ...imageQuestions, ...puzzleQuestions];
                    // Xáo trộn mảng câu hỏi
                    gameQuestions.sort(() => Math.random() - 0.5);
                    break;
            }
            
            // Chỉ lấy tối đa 10 câu hỏi
            if (gameQuestions.length > 10) {
                gameQuestions = gameQuestions.slice(0, 10);
            }
        }
        
        function loadQuestion() {
            // Reset trạng thái
            hasAnswered = false;
            nextBtn.disabled = true;
            feedbackElement.textContent = '';
            feedbackElement.className = 'feedback';
            timeLeft = 30;
            timeElement.textContent = timeLeft;
            currentAnswerTime = 0;
            
            // Ẩn tất cả các container đặc biệt
            imageContainer.classList.add('hide');
            puzzleContainer.classList.add('hide');
            
            // Cập nhật tiến trình
            currentQuestionElement.textContent = currentQuestionIndex + 1;
            progressElement.style.width = `${((currentQuestionIndex + 1) / gameQuestions.length) * 100}%`;
            currentScoreElement.textContent = score;
            
            // Hiển thị câu hỏi hiện tại
            const currentQuestion = gameQuestions[currentQuestionIndex];
            questionText.textContent = currentQuestion.question;
            
            // Xử lý hiển thị dựa trên loại câu hỏi
            switch(currentQuestion.type) {
                case 'multiple-choice':
                case 'true-false':
                    displayMultipleChoiceQuestion(currentQuestion);
                    break;
                case 'fill-blank':
                    displayFillBlankQuestion(currentQuestion);
                    break;
                case 'image-choice':
                    displayImageChoiceQuestion(currentQuestion);
                    break;
                case 'puzzle':
                    displayPuzzleQuestion(currentQuestion);
                    break;
            }
            
            // Bắt đầu đếm thời gian
            startTimer();
        }
        
        function displayMultipleChoiceQuestion(question) {
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('option');
                
                optionElement.innerHTML = `
                    <span class="option-prefix">${String.fromCharCode(65 + index)}</span>
                    <span>${option}</span>
                `;
                
                optionElement.addEventListener('click', () => checkAnswer(index, question));
                optionsContainer.appendChild(optionElement);
            });
        }
        
        function displayFillBlankQuestion(question) {
            optionsContainer.innerHTML = `
                <div class="fill-blank">
                    <form id="fill-form">
                        <p>Nhập câu trả lời của bạn:</p>
                        <input type="text" id="blank-answer" autocomplete="off">
                        <button type="submit" class="btn">Kiểm Tra</button>
                    </form>
                </div>
            `;
            
            document.getElementById('fill-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const userAnswer = document.getElementById('blank-answer').value.toLowerCase().trim();
                checkFillBlankAnswer(userAnswer, question.answer.toLowerCase());
            });
        }